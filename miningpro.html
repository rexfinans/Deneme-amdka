<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Genesis Mining Suite - Kontrol Paneli</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
/* ========================================================================= */
/* --- GENEL STÄ°LLER VE TEMA --- */
/* ========================================================================= */
body, html {
  margin: 0; padding: 0;
  font-family: 'Poppins', sans-serif;
  background: #0D1117; 
  color: #E6EDF3; 
  min-height: 100vh;
  padding-bottom: 70px; 
  line-height: 1.6;
}
.wrapper {
  max-width: 550px; 
  margin: 15px auto;
  padding: 0 15px;
}
header {
  background: #161B22;
  padding: 15px;
  text-align: center;
  font-size: 26px;
  font-weight: 800;
  color: #00BFFF; 
  text-shadow: 0 0 10px rgba(0, 191, 255, 0.6); 
  box-shadow: 0 3px 15px rgba(0, 0, 0, 0.8);
  position: sticky;
  top: 0;
  z-index: 100;
  border-bottom: 1px solid #00BFFF; 
}
header i { margin-right: 10px; }

/* ========================================================================= */
/* --- KARTLAR VE BÄ°LGÄ° ALANLARI --- */
/* ========================================================================= */
.card {
  background: #161B22;
  border-radius: 16px; 
  padding: 25px;
  margin-bottom: 25px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); 
  border: 1px solid #2D333B;
  transition: all 0.5s ease;
}
.card h2 {
    color: #4cd964; 
    font-size: 22px;
    margin-bottom: 15px;
    border-bottom: 2px solid #2D333B;
    padding-bottom: 10px;
    font-weight: 700;
    transition: opacity 0.5s;
    cursor: pointer;
}

/* --- AYAR KARTININ KÃœÃ‡ÃœLME STÄ°LÄ° --- */
#miningSettingsCard.settings-minimized {
    padding: 15px 25px;
    max-height: 60px; 
    overflow: hidden;
    opacity: 0.9;
    border-color: #F3BA2F; 
}
#miningSettingsCard.settings-minimized h2 {
    color: #F3BA2F;
    border-bottom: none;
    margin: 0;
    padding: 0;
}
#miningSettingsCard.settings-minimized > div {
    opacity: 0;
    pointer-events: none;
}

/* ========================================================================= */
/* --- KONTROL KARTI VE Ä°Ã‡ERÄ°K STÄ°LLERÄ° --- */
/* ========================================================================= */
.mining-area { text-align: center; margin: 20px 0; }
.mining-status { font-size: 16px; color: #4cd964; font-weight: 600; margin-bottom: 15px; }
#currentHashrate { 
    font-size: 48px; font-weight: 800; color: #4cd964; 
    text-shadow: 0 0 20px rgba(76, 217, 100, 0.8); transition: color 0.5s, text-shadow 0.5s;
}
.hashrate-unit { font-size: 20px; font-weight: 400; color: #E6EDF3; margin-left: 5px; }

/* SICAKLIK STÄ°LÄ° */
#temperatureDisplay {
    font-size: 16px;
    font-weight: 600;
    margin: 10px 0 15px 0;
    transition: color 0.3s;
}

/* Fan Stilleri (Pervane GÃ¶rÃ¼nÃ¼mÃ¼) */
#fanContainer {
    position: relative; width: 100px; height: 100px; margin: 25px auto;
    border-radius: 50%; background: #000; border: 5px solid #2D333B;
    box-shadow: inset 0 0 10px rgba(0, 191, 255, 0.5), 0 0 20px rgba(0, 191, 255, 0.3);
}
.fan-blade {
    position: absolute; width: 100%; height: 100%; top: 0; left: 0;
    background: radial-gradient(circle, #333 10%, #000 70%);
    /* Pervane ÅŸekli iÃ§in daha iyi bir clip-path */
    clip-path: polygon(50% 50%, 65% 15%, 55% 0%, 45% 0%, 35% 15%);
    opacity: 0.8;
}
/* ÃœÃ§ kanat oluÅŸturuluyor */
.fan-blade:nth-child(1) { transform: rotate(0deg); }
.fan-blade:nth-child(2) { transform: rotate(120deg); }
.fan-blade:nth-child(3) { transform: rotate(240deg); }

#fanContainer::before {
    content: ''; position: absolute; top: 50%; left: 50%;
    transform: translate(-50%, -50%); width: 20px; height: 20px;
    border-radius: 50%; background: #00BFFF; z-index: 10;
}
.fan-spin { animation: spin 0.8s linear infinite; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* SayaÃ§ ve Buton Stilleri */
#countdownTimer { 
    font-size: 18px; font-weight: 700; color: #F3BA2F; margin-top: 15px; padding: 10px; 
    border: 1px solid #F3BA2F; border-radius: 8px; display: inline-block; background: #2D333B;
}
#toggleMiningBtn {
    padding: 18px 30px; border: none; border-radius: 50px; font-weight: 800; font-size: 20px; 
    color: #0D1117; cursor: pointer; transition: all 0.3s ease; margin-top: 25px; min-width: 250px;
    display: inline-flex; align-items: center; justify-content: center;
}
.mining-off { background: #4CD964; box-shadow: 0 0 20px rgba(76, 217, 100, 0.7), 0 5px 15px rgba(0,0,0,0.4); }
.mining-on { background: #FF0057; box-shadow: 0 0 20px rgba(255, 0, 87, 0.7), 0 5px 15px rgba(0,0,0,0.4); }

/* Bakiye Stilleri */
.balance-display {
    text-align: center; padding: 15px; border-radius: 12px; margin-bottom: 20px;
    background: #0D1117; border: 1px solid #00BFFF; box-shadow: inset 0 0 10px rgba(0, 191, 255, 0.3);
}
#miningBalance {
    font-size: 36px; font-weight: 800; color: #00BFFF; text-shadow: 0 0 15px rgba(0, 191, 255, 0.8);
}

/* Kripto ve HÄ±z SeÃ§im Stilleri */
.select-group { margin-bottom: 20px; border: 1px solid #2D333B; padding: 15px; border-radius: 8px; }
.select-group label { display: block; margin-bottom: 10px; font-weight: 600; color: #CCC; font-size: 16px; }
.crypto-selection { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
.crypto-item {
    padding: 10px 15px; border: 2px solid #2D333B; border-radius: 10px; cursor: pointer;
    transition: all 0.3s; font-weight: 600; display: flex; align-items: center; gap: 8px;
    background: #0D1117;
}
.crypto-item.selected { border-color: #F3BA2F; background: rgba(243, 186, 47, 0.1); color: #F3BA2F; }
.speed-option {
    margin-bottom: 15px; padding: 10px; border: 1px solid #2D333B; border-radius: 8px;
    background: #161B22; display: flex; flex-direction: column; gap: 10px; transition: border-color 0.3s;
}
.speed-option.selected { border-color: #00BFFF; background: rgba(0, 191, 255, 0.1); }
.speed-option-header { display: flex; justify-content: space-between; align-items: center; font-weight: 700; cursor: pointer; }
.speed-multiplier { font-size: 20px; color: #4cd964; }
.speed-multiplier.paid { color: #F3BA2F; }
.speed-details { overflow: hidden; max-height: 0; transition: max-height 0.4s ease-out; padding-top: 0; }
.speed-details.open { max-height: 150px; padding-top: 10px; } /* max-height azaltÄ±ldÄ± */
.speed-details input[type="text"] {
    padding: 10px; border-radius: 5px; border: 1px solid #363b43; background: #0D1117;
    color: #E6EDF3; width: calc(100% - 22px); margin-bottom: 10px;
}
.speed-details .action-buttons { display: flex; gap: 10px; }
.speed-details button { padding: 10px; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; flex: 1; transition: background 0.3s; }
.btn-key { background: #00BFFF; color: #0D1117; }
.btn-buy { background: #F3BA2F; color: #0D1117; }
/* SÃ¼re SeÃ§enekleri kaldÄ±rÄ±ldÄ±ÄŸÄ± iÃ§in bu stil artÄ±k kullanÄ±lmayacak */
/* .duration-selector { display: flex; gap: 10px; margin-top: 10px; margin-bottom: 10px; }
.duration-item { flex: 1; padding: 8px; border: 1px solid #2D333B; border-radius: 5px; text-align: center; cursor: pointer; font-size: 14px; transition: all 0.3s; }
.duration-item.selected { border-color: #4cd964; background: rgba(76, 217, 100, 0.1); color: #4cd964; } */

/* Alt menÃ¼ */
.bottom-menu { 
    position:fixed; bottom:0; left:0; width:100%; display:flex; justify-content:space-around;
    background:#161B22; padding:10px 0; box-shadow:0 -5px 15px rgba(0,0,0,0.5); z-index:99;
    border-top: 1px solid #2D333B;
}
.bottom-menu a {
    flex:1; text-decoration: none; text-align: center; margin:0 5px; padding:8px 0;
    font-size:12px; background:transparent; color:#777; border-radius:8px; transition:.3s;
    font-weight: 600; 
}
.bottom-menu a i { font-size: 20px; display: block; margin-bottom: 4px; }
.bottom-menu a.active { 
    color:#F3BA2F;
    background: rgba(243, 186, 47, 0.1); 
    text-shadow: 0 0 5px rgba(243, 186, 47, 0.6);
}

/* YÃ¼zen UyarÄ± */
#floatingAlert {
    position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px);
    z-index: 10000; padding: 15px 25px; border-radius: 10px; font-weight: 700; color: #121212;
    box-shadow: 0 5px 20px rgba(0,0,0,0.4); transition: opacity 0.4s, transform 0.4s;
    opacity: 0; pointer-events: none; max-width: 90%; text-align: center;
}
#floatingAlert.show { opacity: 1; transform: translateX(-50%) translateY(0); }
.alert-success { background: #4cd964; }
.alert-error { background: #ff0057; }
.alert-info { background: #00bfff; }

/* Yeni Bilgilendirme AlanÄ± Stilleri */
.info-section {
    background: #161B22;
    border-radius: 16px;
    padding: 25px;
    margin-bottom: 25px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); 
    border: 1px solid #2D333B;
}
.info-section h3 {
    color: #00BFFF;
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 15px;
    border-bottom: 1px solid #2D333B;
    padding-bottom: 10px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
}
.info-section p {
    font-size: 14px;
    color: #A0A0A0;
    margin-bottom: 15px;
}
.info-section ul {
    list-style: none;
    padding-left: 0;
}
.info-section ul li {
    padding: 8px 0;
    border-bottom: 1px dashed #2D333B;
    font-size: 14px;
    display: flex;
    align-items: center;
}
.info-section ul li i {
    color: #4cd964;
    margin-right: 10px;
}
.info-section ul li:last-child {
    border-bottom: none;
}
</style>
</head>
<body>

<div id="floatingAlert" class="alert-info"></div>
<header><i class="fas fa-microchip"></i> MiningPRO</header>
<div class="wrapper">

    <div class="card" id="miningSettingsCard">
        <h2 onclick="toggleSettingsCard()">âš™ï¸ Kripto Ve HÄ±z SeÃ§imi</h2>

        <div class="select-group" id="cryptoSelectionGroup">
            <label>Hedef VarlÄ±k SeÃ§imi:</label>
            <div class="crypto-selection" id="cryptoSelection">
                </div>
        </div>

        <div class="select-group" id="speedSelectionGroup">
            <label>Ã‡ekirdek Ä°ÅŸlemci HÄ±zÄ± (Core Rate):</label>
            <div id="speedOptions">
                <div class="speed-option" data-speed="3">
                    <div class="speed-option-header" onclick="handleSpeedClick(3, event)">
                        <span class="speed-multiplier">3x (Temel Tahsis)</span>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="speed-details">
                        <p>Standart hash gÃ¼cÃ¼ tahsisidir. Ãœcretsiz ve sÄ±nÄ±rsÄ±z kullanÄ±m sunar.</p>
                    </div>
                </div>

                <div class="speed-option" data-speed="7">
                    <div class="speed-option-header" onclick="handleSpeedClick(7, event)">
                        <span class="speed-multiplier paid">7x (Premium Hash) <i class="fas fa-lock"></i></span>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="speed-details">
                        <p>PerformansÄ± Ã¶nemli Ã¶lÃ§Ã¼de artÄ±rÄ±r. Lisans anahtarÄ± veya satÄ±n alma gereklidir.</p>
                        <input type="text" placeholder="Aktivasyon Lisans AnahtarÄ±nÄ± Girin" id="keyInput7">
                        <div class="action-buttons">
                            <button class="btn-key" onclick="activateSpeed(7, document.getElementById('keyInput7').value)">AnahtarÄ± Kullan</button>
                            <button class="btn-buy" onclick="redirectToBuy()">SatÄ±n Al</button>
                        </div>
                    </div>
                </div>

                <div class="speed-option" data-speed="10">
                    <div class="speed-option-header" onclick="handleSpeedClick(10, event)">
                        <span class="speed-multiplier paid">10x (Ultra Ä°ÅŸlemci) <i class="fas fa-lock"></i></span>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="speed-details">
                        <p>YÃ¼ksek hÄ±z ve verimlilik saÄŸlar. Lisans anahtarÄ± veya satÄ±n alma gereklidir.</p>
                        <input type="text" placeholder="Aktivasyon Lisans AnahtarÄ±nÄ± Girin" id="keyInput10">
                        <div class="action-buttons">
                            <button class="btn-key" onclick="activateSpeed(10, document.getElementById('keyInput10').value)">AnahtarÄ± Kullan</button>
                            <button class="btn-buy" onclick="redirectToBuy()">SatÄ±n Al</button>
                        </div>
                    </div>
                </div>

                <div class="speed-option" data-speed="20">
                    <div class="speed-option-header" onclick="handleSpeedClick(20, event)">
                        <span class="speed-multiplier paid">20x (Genesis Maksimum) <i class="fas fa-lock"></i></span>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="speed-details">
                        <p>Maksimum Hashrate Kapasitesi. Lisans anahtarÄ± veya satÄ±n alma gereklidir.</p>
                        <input type="text" placeholder="Aktivasyon Lisans AnahtarÄ±nÄ± Girin" id="keyInput20">
                        <div class="action-buttons">
                            <button class="btn-key" onclick="activateSpeed(20, document.getElementById('keyInput20').value)">AnahtarÄ± Kullan</button>
                            <button class="btn-buy" onclick="redirectToBuy()">SatÄ±n Al</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <h2>ğŸ“Š MADENCÄ°LÄ°K DURUMU</h2>
        
        <div class="mining-area">
            <div id="fanContainer">
                <div class="fan-blade"></div>
                <div class="fan-blade"></div>
                <div class="fan-blade"></div>
            </div>

            <div class="mining-status" id="miningStatusText">Sistem Durumu: Ã‡evrimdÄ±ÅŸÄ± (Pasif)</div> 
            
            <div id="currentHashrate">0.00 <span class="hashrate-unit">MH/s</span></div>
            
            <div id="temperatureDisplay">SÄ±caklÄ±k: 45Â°C (BoÅŸta)</div>
            
            <div id="countdownTimer">Aktif Oturum SÃ¼resi: 12:00:00</div>

            <button id="toggleMiningBtn" class="mining-off" onclick="toggleMining()">
                <i class="fas fa-play"></i> MADENCÄ°LÄ°ÄÄ° BAÅLAT
            </button>
        </div>
    </div>

    <div class="card">
        <h2>ğŸ’° VarlÄ±k Bilgisi</h2>
        <p style="font-size:14px; color:#999; margin-top:-10px; margin-bottom:15px; border-bottom: 1px dashed #2D333B; padding-bottom: 10px;">
            Hacim AktarÄ±m ProtokolÃ¼ (VAP) ile eÅŸ zamanlÄ± toplanan varlÄ±k bakiyeniz.
        </p>
        <div class="balance-display">
            <div class="label">Toplanan VarlÄ±k MiktarÄ± (<span id="currentCryptoUnit">USDT</span>):</div>
            <div id="miningBalance">0.000000 <span>USDT</span></div>
            <div id="speedMultiplier">Aktif Ä°ÅŸlemci HÄ±zÄ±: 3x</div>
        </div>
        <div class="status-info" id="transferInfo">
            <i class="fas fa-info-circle"></i> VAP oturumu (12 saat) tamamlandÄ±ÄŸÄ±nda, toplanan varlÄ±klar cÃ¼zdanÄ±nÄ±za otomatik transfer edilir.
        </div>
    </div>

    <div class="info-section">
        <h3><i class="fas fa-shield-alt"></i> GÃ¼venlik Protokolleri ve VAP</h3>
        <p>
            **Genesis Mining Suite**, mobil cihazÄ±nÄ±zÄ±n atÄ±l iÅŸlem gÃ¼cÃ¼nÃ¼, optimize edilmiÅŸ bir VAP (Hacim AktarÄ±m ProtokolÃ¼) algoritmasÄ± aracÄ±lÄ±ÄŸÄ±yla kripto varlÄ±k Ã¼retimi iÃ§in kullanÄ±r. Sistem, cihazÄ±nÄ±za minimum yÃ¼k bindirerek termal stabiliteyi korur.
        </p>
        <ul>
            <li><i class="fas fa-check-circle"></i> **AES-256 Åifreleme:** TÃ¼m veri ve iÅŸlem bilgileri askeri dÃ¼zeyde ÅŸifreleme ile korunur.</li>
            <li><i class="fas fa-check-circle"></i> **Zero-Knowledge Proof:** CÃ¼zdan adresleri ve transferler izlenemez (Gizlilik Ã–nceliklidir).</li>
            <li><i class="fas fa-check-circle"></i> **Dinamik Termal YÃ¶netim:** Ä°ÅŸlemci sÄ±caklÄ±ÄŸÄ± 70Â°C Ã¼zerine Ã§Ä±ktÄ±ÄŸÄ±nda hÄ±z otomatik olarak dÃ¼ÅŸÃ¼rÃ¼lÃ¼r.</li>
        </ul>
    </div>

    <div class="info-section">
        <h3><i class="fas fa-bolt"></i> Premium HÄ±z YÃ¼kseltmeleri</h3>
        <p>
            Premium HÄ±z YÃ¼kseltmeleri (7x, 10x, 20x), tahsis edilen Hashrate kapasitesini maksimize eder. Bu hÄ±zlarÄ± aktive etmek iÃ§in **Lisans AnahtarÄ±** kullanmanÄ±z veya **SatÄ±n Alma** yapmanÄ±z gerekmektedir.
        </p>
        <div style="text-align: center; margin-top: 10px;">
             <a href="hizal.html" style="color: #F3BA2F; text-decoration: none; font-weight: 700;">
                <i class="fas fa-external-link-alt"></i> HÄ±z SatÄ±n Alma Terminaline Git
            </a>
        </div>
    </div>
    
</div>

<div class="bottom-menu">
  <a href="miningpro.html" id="tabMining" class="active"><i class="fas fa-tachometer-alt"></i> Madencilik</a>
  <a href="hizal.html" id="tabHizAl"><i class="fas fa-bolt"></i> HÄ±z YÃ¼kselt</a>
  <a href="kazan.html" id="tabKazan"><i class="fas fa-trophy"></i> Ã–dÃ¼l Havuzu</a>
  <a href="cÃ¼zdanÄ±m.html" id="tabWallet"><i class="fas fa-wallet"></i> CÃ¼zdan</a>
</div>

<div class="wrapper" style="margin-top: 0; padding-top: 0;">
    <div style="text-align: center; color: #555; font-size: 11px; padding: 20px 0;">
        &copy; 2025 Genesis Mining Technologies. TÃ¼m haklarÄ± saklÄ±dÄ±r.
        <br><br>
        <a href="#" style="color: #00BFFF; text-decoration: none; margin: 0 5px;">Gizlilik PolitikasÄ±</a> | 
        <a href="#" style="color: #00BFFF; text-decoration: none; margin: 0 5px;">Hizmet ÅartlarÄ±</a> | 
        <a href="#" style="color: #00BFFF; text-decoration: none; margin: 0 5px;">Sponsorlar</a>
    </div>
</div>
<script type="module">
// =========================================================================
// --- FIREBASE ENTEGRASYONU (AyarlarÄ±nÄ±zÄ± Buraya Girin) ---
// =========================================================================
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

// âš ï¸ LÃœTFEN KENDÄ° FIREBASE AYARLARINIZLA DEÄÄ°ÅTÄ°RÄ°N
const firebaseConfig = {
  apiKey: "AIzaSyBwpgITzHh2K3oYTRDaNbGVexPR8IcqXBU",
  authDomain: "coinbase-a1aca.firebaseapp.com",
  projectId: "coinbase-a1aca",
  storageBucket: "coinbase-a1aca.firebasestorage.app",
  messagingSenderId: "596259885244",
  appId: "1:596259885244:web:186df79a6ccdc96f0d00b9",
  measurementId: "G-Q4SMPE62HF"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getDatabase(app);


// =========================================================================
// --- KRÄ°PTO VE HIZ AYARLARI ---
// =========================================================================
const CRYPTOS = [
    { id: 'usdt', name: 'USDT', icon: 'fas fa-dollar-sign', dailyRate: 1.00 },
    { id: 'btc', name: 'Bitcoin', icon: 'fab fa-bitcoin', dailyRate: 0.000018 },
    { id: 'eth', name: 'Ethereum', icon: 'fab fa-ethereum', dailyRate: 0.0003 },
    { id: 'sol', name: 'Solana', icon: 'fab fa-solana', dailyRate: 0.008 },
    { id: 'bnb', name: 'BNB', icon: 'fas fa-coins', dailyRate: 0.004 },
    { id: 'xrp', name: 'XRP', icon: 'fas fa-handshake', dailyRate: 2.5 },
    { id: 'ada', name: 'Cardano', icon: 'fas fa-tag', dailyRate: 3.0 },
    { id: 'doge', name: 'Dogecoin', icon: 'fas fa-paw', dailyRate: 15.0 },
    { id: 'matic', name: 'Polygon', icon: 'fas fa-gem', dailyRate: 1.2 },
    { id: 'dot', name: 'Polkadot', icon: 'fas fa-bullseye', dailyRate: 0.15 },
    { id: 'ltc', name: 'Litecoin', icon: 'fas fa-lira-sign', dailyRate: 0.015 },
    { id: 'trx', name: 'Tron', icon: 'fas fa-cubes', dailyRate: 10.0 },
];

let miningInterval;
let countdownInterval;
let userID = null;

// =========================================================================
// --- YARDIMCI FONKSÄ°YONLAR VE LOKAL DEPOLAMA ---
// =========================================================================

let alertTimeout = null;
function showFloatingAlert(message, type = 'info', duration = 3000) {
    const alertEl = document.getElementById('floatingAlert');
    if (!alertEl) return;
    clearTimeout(alertTimeout);
    alertEl.className = '';
    alertEl.classList.add(`alert-${type}`);
    alertEl.innerText = message;
    alertEl.classList.add('show');
    alertTimeout = setTimeout(() => {
        alertEl.classList.remove('show');
    }, duration);
}

function getAppState() {
    const defaultState = {
        isMining: false,
        miningBalance: 0.0,
        fanSpeed: 3, 
        selectedCrypto: 'usdt',
        lastUpdateTime: Date.now(),
        miningEndTime: 0,
        purchasedSpeeds: {
            // SÃ¼re seÃ§enekleri kaldÄ±rÄ±ldÄ±ÄŸÄ± iÃ§in bu objenin yapÄ±sÄ± basitleÅŸtirilebilir. 
            // Åimdilik sadece anahtarÄ±n varlÄ±ÄŸÄ±/yokluÄŸu kontrol edilebilir.
            // Ã–rn: { 7: true, 10: false }
        }, 
        // Eski duration-based mantÄ±k kaldÄ±rÄ±ldÄ±ÄŸÄ± iÃ§in expiration kontrolÃ¼ gerekmez, 
        // ancak eski verilerin bozulmamasÄ± iÃ§in geÃ§ici olarak tutulabilir.
    };
    
    const state = localStorage.getItem(`miningProState_${userID}`);
    const loadedState = state ? JSON.parse(state) : defaultState;

    if (loadedState.isMining) {
        if (loadedState.miningEndTime > 0 && loadedState.miningEndTime < Date.now()) {
            loadedState.isMining = false;
            loadedState.miningEndTime = 0;
            loadedState.miningBalance = 0.0; 
            showFloatingAlert('VAP Oturumu dolmuÅŸ. LÃ¼tfen tekrar baÅŸlatÄ±n.', 'info', 5000);
        }
    } else {
        loadedState.lastUpdateTime = Date.now();
    }
    
    // Fan hÄ±zÄ± kontrolÃ¼: EÄŸer lisansÄ± olmayan bir hÄ±zda kaldÄ±ysa 3x'e Ã§ek
    if (loadedState.fanSpeed !== 3 && !loadedState.purchasedSpeeds[loadedState.fanSpeed]) {
        loadedState.fanSpeed = 3;
    }
    
    return loadedState;
}

function saveAppState(state) {
    localStorage.setItem(`miningProState_${userID}`, JSON.stringify(state));
    if (userID) {
         set(ref(db, 'users/' + userID + '/miningData'), {
            fanSpeed: state.fanSpeed,
            selectedCrypto: state.selectedCrypto,
            purchasedSpeeds: state.purchasedSpeeds,
        }).catch(error => {
            console.error("Firebase'e kaydetme hatasÄ±:", error);
        });
    }
}

function calculateHashrate(speedMultiplier) {
    const BASE_HASHRATE = 0.15; 
    const RATE_PER_MULTIPLIER = 0.03; 
    return (BASE_HASHRATE + (speedMultiplier - 3) * RATE_PER_MULTIPLIER).toFixed(3);
}

function updateMiningBalance(appState) {
    const now = Date.now();
    const timeElapsedHours = (now - appState.lastUpdateTime) / (1000 * 60 * 60);

    if (appState.isMining && timeElapsedHours > 0) {
        const crypto = CRYPTOS.find(c => c.id === appState.selectedCrypto);
        if (!crypto) return;

        const dailyRate = crypto.dailyRate * (appState.fanSpeed / 3); 
        const earnings = dailyRate * timeElapsedHours / 24;
        
        appState.miningBalance += earnings;
        appState.lastUpdateTime = now; 
        saveAppState(appState);
    }
}

// =========================================================================
// --- KART KONTROL FONKSÄ°YONLARI ---
// =========================================================================

function toggleSettingsCardVisibility(minimize) {
    const settingsCard = document.getElementById('miningSettingsCard');
    if (!settingsCard) return;

    if (minimize) {
        settingsCard.classList.add('settings-minimized');
    } else {
        settingsCard.classList.remove('settings-minimized');
    }
}

window.toggleSettingsCard = function() {
    const settingsCard = document.getElementById('miningSettingsCard');
    if (!settingsCard) return;
    
    if (getAppState().isMining) {
        showFloatingAlert('Algoritma aktifken parametreleri deÄŸiÅŸtiremezsiniz. Ã–nce durdurun.', 'error');
        return;
    }

    if (settingsCard.classList.contains('settings-minimized')) {
        toggleSettingsCardVisibility(false);
        toggleSpeedDetails(getAppState().fanSpeed, true);
    }
}

function toggleSpeedDetails(speed, forceOpen = false) {
    const option = document.querySelector(`.speed-option[data-speed="${speed}"]`);
    if (!option) return;

    const details = option.querySelector('.speed-details');
    const chevron = option.querySelector('.speed-option-header i');

    document.querySelectorAll('.speed-option').forEach(opt => {
        const det = opt.querySelector('.speed-details');
        const chev = opt.querySelector('.speed-option-header i');
        if (opt !== option && det.classList.contains('open')) {
            det.classList.remove('open');
            if (chev) chev.classList.replace('fa-chevron-down', 'fa-chevron-right');
        }
    });

    if (forceOpen || !details.classList.contains('open')) {
        details.classList.add('open');
        if (chevron) chevron.classList.replace('fa-chevron-right', 'fa-chevron-down');
    } else {
        details.classList.remove('open');
        if (chevron) chevron.classList.replace('fa-chevron-down', 'fa-chevron-right');
    }
}


window.handleSpeedClick = function(speed, event) {
    const appState = getAppState();

    if (event && (event.target.closest('.action-buttons') || event.target.closest('.duration-selector'))) {
        return; 
    }
    
    if (appState.isMining) {
         showFloatingAlert('Algoritma aktifken hÄ±zÄ± deÄŸiÅŸtiremezsiniz.', 'error');
         return;
    }
    
    // EÄŸer seÃ§ilen hÄ±z 3x'ten bÃ¼yÃ¼kse ve satÄ±n alÄ±nmamÄ±ÅŸsa (lisanssÄ±zsa), hÄ±z deÄŸiÅŸikliÄŸini engelle
    if (speed > 3 && !appState.purchasedSpeeds[speed]) {
        // Sadece 3x ise direk seÃ§
        if (speed === 3) {
            appState.fanSpeed = speed;
            saveAppState(appState);
            updateUI(appState);
            showFloatingAlert(`Temel Core Rate ${speed}x olarak seÃ§ildi.`, 'success');
            toggleSettingsCardVisibility(true);
            return;
        }
        
        // LisanssÄ±z hÄ±zÄ± sadece aÃ§Ä±lÄ±r pencereyi gÃ¶stermek iÃ§in ayarla, asÄ±l hÄ±zÄ± 3x'te tut.
        // AslÄ±nda appState.fanSpeed'i deÄŸiÅŸtirmemek daha mantÄ±klÄ±, sadece UI'Ä± gÃ¼ncellemek iÃ§in toggleDetails kullan.
        toggleSpeedDetails(speed);
        return;
    }
    
    // LisanslÄ± veya 3x ise hÄ±zÄ± deÄŸiÅŸtir
    appState.fanSpeed = speed; 
    saveAppState(appState);
    updateUI(appState);
    
    toggleSpeedDetails(speed);
    toggleSettingsCardVisibility(true); // HÄ±z seÃ§ildiÄŸinde kartÄ± kÃ¼Ã§Ã¼lt
}


function selectCrypto(cryptoId) {
    let appState = getAppState();
    
    if (appState.isMining) {
        showFloatingAlert('Algoritma aktifken hedef varlÄ±k deÄŸiÅŸtiremezsiniz.', 'error');
        return;
    }
    
    if (appState.selectedCrypto === cryptoId && !document.getElementById('miningSettingsCard').classList.contains('settings-minimized')) {
        return;
    }
    
    appState.selectedCrypto = cryptoId;
    saveAppState(appState);
    updateUI(appState);
    showFloatingAlert(`${cryptoId.toUpperCase()} hedef varlÄ±k olarak atandÄ±.`, 'info');
    
    toggleSettingsCardVisibility(true);
}

function setupCryptoSelection() {
    const container = document.getElementById('cryptoSelection');
    container.innerHTML = '';
    CRYPTOS.forEach(crypto => {
        const item = document.createElement('div');
        item.className = `crypto-item ${crypto.id === getAppState().selectedCrypto ? 'selected' : ''}`;
        item.dataset.crypto = crypto.id;
        item.innerHTML = `<i class="${crypto.icon}"></i> ${crypto.name}`;
        item.addEventListener('click', () => selectCrypto(crypto.id));
        container.appendChild(item);
    });
}

// SÃ¼re opsiyonlarÄ± kaldÄ±rÄ±ldÄ±ÄŸÄ± iÃ§in bu fonksiyon basitleÅŸtirildi.
window.activateSpeed = function(speed, key) {
    let appState = getAppState();

    if (key.length < 8) {
        showFloatingAlert('GeÃ§ersiz lisans anahtarÄ± uzunluÄŸu!', 'error');
        return;
    }
    if (appState.isMining) {
        showFloatingAlert('Algoritma aktifken lisans kullanamazsÄ±nÄ±z.', 'error');
        return;
    }
    
    // Anahtar geÃ§erli kabul edildi (SimÃ¼lasyon amaÃ§lÄ±)
    appState.purchasedSpeeds[speed] = true;
    appState.fanSpeed = speed;
    saveAppState(appState);
    updateUI(appState);
    
    showFloatingAlert(`${speed}x Ä°ÅŸlemci HÄ±zÄ± aktive edildi!`, 'success');
    
    toggleSettingsCardVisibility(true);
}

// TÃ¼m SatÄ±n Al butonlarÄ± hizal.html'ye yÃ¶nlendirir.
window.redirectToBuy = function() {
    window.location.href = 'hizal.html';
}

// KazÄ±m BaÅŸlatma/Durdurma (PROFESYONEL Ä°FADE)
window.toggleMining = function() {
    let appState = getAppState();
    
    appState.isMining = !appState.isMining;
    appState.lastUpdateTime = Date.now(); 

    if (appState.isMining) {
        appState.miningEndTime = Date.now() + 12 * 60 * 60 * 1000;
        showFloatingAlert(`HASH AlgoritmasÄ± ${appState.fanSpeed}x hÄ±z ile baÅŸlatÄ±ldÄ±. Ä°ÅŸlemci durumu: Optimal.`, 'success');
        startMiningLoop();
        startCountdown();
        toggleSettingsCardVisibility(true); 
    } else {
        appState.miningEndTime = 0;
        showFloatingAlert('Sistem Pasif Edildi. Hacim AktarÄ±m ProtokolÃ¼ Durduruldu.', 'error');
        clearInterval(miningInterval);
        clearInterval(countdownInterval);
        document.getElementById('fanContainer').classList.remove('fan-spin');
        toggleSettingsCardVisibility(false); 
    }
    
    saveAppState(appState);
    updateUI(appState);
}

// SÃ¼re kontrolÃ¼ kaldÄ±rÄ±ldÄ±, sadece lisans var mÄ± yok mu kontrolÃ¼ yapÄ±labilir.
function checkSpeedExpiry(appState) {
    // Åimdilik sadece aktif hÄ±zÄ±n lisanslÄ± olup olmadÄ±ÄŸÄ±nÄ± kontrol et.
    if (appState.fanSpeed > 3 && !appState.purchasedSpeeds[appState.fanSpeed]) {
        appState.fanSpeed = 3;
        saveAppState(appState);
        showFloatingAlert(`Aktif hÄ±z lisansÄ± bulunamadÄ±. Temel tahsise (3x) dÃ¶nÃ¼ldÃ¼.`, 'error');
    }
}

// SayaÃ§ GÃ¼ncelleme (PROFESYONEL Ä°FADE)
function updateCountdown(appState) {
    const timerDisplay = document.getElementById('countdownTimer');
    const now = Date.now();
    const remainingTime = appState.miningEndTime - now;

    if (remainingTime <= 0) {
        clearInterval(countdownInterval);
        clearInterval(miningInterval);
        
        const balance = appState.miningBalance.toFixed(6);
        const cryptoUnit = appState.selectedCrypto.toUpperCase();

        appState.miningBalance = 0.0;
        appState.isMining = false;
        appState.miningEndTime = 0;
        saveAppState(appState);
        updateUI(appState);
        
        document.getElementById('fanContainer').classList.remove('fan-spin');
        timerDisplay.innerText = 'Aktif Oturum SÃ¼resi: 12:00:00';
        showFloatingAlert(`VAP Oturumu SonlandÄ±! ${balance} ${cryptoUnit} envantere transfer edildi.`, 'success', 8000);
        toggleSettingsCardVisibility(false); 
        return;
    }

    const hours = Math.floor(remainingTime / (1000 * 60 * 60));
    const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);

    timerDisplay.innerText = `Aktif Oturum SÃ¼resi: ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
}

function startCountdown() {
    clearInterval(countdownInterval);
    countdownInterval = setInterval(() => {
        let appState = getAppState();
        if (appState.isMining) {
            updateCountdown(appState);
        } else {
            clearInterval(countdownInterval);
        }
    }, 1000);
}


// UI GÃ¼ncelleme (PROFESYONEL Ä°FADE)
function updateUI(appState) {
    const btn = document.getElementById('toggleMiningBtn');
    const statusText = document.getElementById('miningStatusText');
    const hashrateDisplay = document.getElementById('currentHashrate');
    const balanceDisplay = document.getElementById('miningBalance');
    const speedDisplay = document.getElementById('speedMultiplier');
    const currentCryptoUnit = document.getElementById('currentCryptoUnit');
    const fanContainer = document.getElementById('fanContainer');
    const countdownTimer = document.getElementById('countdownTimer');
    const temperatureDisplay = document.getElementById('temperatureDisplay');
    
    const crypto = CRYPTOS.find(c => c.id === appState.selectedCrypto) || CRYPTOS[0];

    balanceDisplay.innerHTML = `${appState.miningBalance.toFixed(6)} <span>${crypto.name}</span>`;
    speedDisplay.innerText = `Aktif Ä°ÅŸlemci HÄ±zÄ±: ${appState.fanSpeed}x`;
    currentCryptoUnit.innerText = crypto.name;
    
    // Kripto ve HÄ±z SeÃ§imlerini GÃ¼ncelle
    document.querySelectorAll('.crypto-item').forEach(el => {
        if (el.dataset.crypto === appState.selectedCrypto) {
            el.classList.add('selected');
        } else {
            el.classList.remove('selected');
        }
    });
    
    document.querySelectorAll('.speed-option').forEach(el => {
        const speed = parseInt(el.dataset.speed);
        
        // LisanslÄ± olmayan hÄ±zlarda kilidi tekrar gÃ¶ster
        const lockIcon = el.querySelector('.speed-multiplier i.fa-lock');
        if (speed > 3 && !appState.purchasedSpeeds[speed]) {
            if (lockIcon) lockIcon.style.display = 'inline';
        } else {
            if (lockIcon) lockIcon.style.display = 'none';
        }
        
        // SeÃ§ili hÄ±zÄ± vurgula
        if (speed === appState.fanSpeed) {
            el.classList.add('selected');
        } else {
            el.classList.remove('selected');
        }
    });

    // Buton ve Durum GÃ¼ncelleme
    if (appState.isMining) {
        btn.classList.remove('mining-off');
        btn.classList.add('mining-on');
        btn.innerHTML = '<i class="fas fa-power-off"></i> DURDUR';
        statusText.style.color = '#4cd964';
        statusText.innerText = `Sistem Durumu: Ã‡ekirdekler ${appState.fanSpeed}x HÄ±zda (Aktif)`;
        
        const currentHashrate = calculateHashrate(appState.fanSpeed);
        hashrateDisplay.innerHTML = `${currentHashrate} <span class="hashrate-unit">MH/s</span>`;
        hashrateDisplay.style.color = '#4cd964';
        hashrateDisplay.style.textShadow = '0 0 20px rgba(76, 217, 100, 0.8)';
        fanContainer.classList.add('fan-spin');
        
        // Dinamik SÄ±caklÄ±k SimÃ¼lasyonu
        const temp = 55 + (appState.fanSpeed - 3) * 3 + Math.floor(Math.random() * 5); 
        temperatureDisplay.innerText = `SÄ±caklÄ±k: ${temp}Â°C (Optimal)`;
        temperatureDisplay.style.color = temp > 75 ? '#ff0057' : '#E6EDF3';

        
    } else {
        btn.classList.remove('mining-on');
        btn.classList.add('mining-off');
        btn.innerHTML = '<i class="fas fa-play"></i> MADENCÄ°LÄ°ÄÄ° BAÅLAT';
        statusText.style.color = '#ff0057';
        statusText.innerText = 'Sistem Durumu: Ã‡evrimdÄ±ÅŸÄ± (Pasif)';
        
        hashrateDisplay.innerHTML = `0.00 <span class="hashrate-unit">MH/s</span>`;
        hashrateDisplay.style.color = '#E6EDF3';
        hashrateDisplay.style.textShadow = 'none';
        fanContainer.classList.remove('fan-spin');
        temperatureDisplay.innerText = 'SÄ±caklÄ±k: 45Â°C (BoÅŸta)';
        temperatureDisplay.style.color = '#E6EDF3';
        
        countdownTimer.innerText = 'Aktif Oturum SÃ¼resi: 12:00:00'; 
    }
}


function startMiningLoop() {
    if (miningInterval) {
        clearInterval(miningInterval);
    }
    
    // Her 5 saniyede bir bakiyeyi ve sÃ¼reyi kontrol et
    miningInterval = setInterval(() => {
        let appState = getAppState();
        if (appState.isMining) {
            updateMiningBalance(appState);
            checkSpeedExpiry(appState); // Lisans kontrolÃ¼
            updateUI(appState);
        } else {
            clearInterval(miningInterval);
        }
    }, 5000); 
}


// BaÅŸlangÄ±Ã§ Fonksiyonu
function init() {
    setupCryptoSelection();
    
    // Duration listener'larÄ± kaldÄ±rÄ±ldÄ±.

    let appState = getAppState();
    
    checkSpeedExpiry(appState);
    updateMiningBalance(appState); 
    updateUI(appState); 

    if (appState.isMining || appState.fanSpeed > 3) {
        toggleSettingsCardVisibility(true); 
    } else {
        toggleSettingsCardVisibility(false);
    }

    if (appState.isMining) {
        startMiningLoop();
        startCountdown();
    } else {
        document.getElementById('countdownTimer').innerText = 'Aktif Oturum SÃ¼resi: 12:00:00'; 
    }
}


<script type="module">
// =========================================================================
// --- FIREBASE ENTEGRASYONU (AyarlarÄ±nÄ±zÄ± Buraya Girin) ---
// =========================================================================
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

// âš ï¸ LÃœTFEN KENDÄ° FIREBASE AYARLARINIZLA DEÄÄ°ÅTÄ°RÄ°N
const firebaseConfig = {
  apiKey: "AIzaSyBwpgITzHh2K3oYTRDaNbGVexPR8IcqXBU",
  authDomain: "coinbase-a1aca.firebaseapp.com",
  projectId: "coinbase-a1aca",
  storageBucket: "coinbase-a1aca.firebasestorage.app",
  messagingSenderId: "596259885244",
  appId: "1:596259885244:web:186df79a6ccdc96f0d00b9",
  measurementId: "G-Q4SMPE62HF"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getDatabase(app);

// ... [Kalan tÃ¼m global deÄŸiÅŸkenler ve yardÄ±mcÄ± fonksiyonlar buraya taÅŸÄ±nmalÄ±dÄ±r (CRYPTOS, getAppState, updateUI vb.)] ...

// =========================================================================
// âœ… GÄ°RÄ°Å KONTROLÃœ VE BAÅLATMA
// =========================================================================
let userID = null;

function init() {
    // TÃ¼m UI ve mantÄ±k baÅŸlatma iÅŸlemleri
    setupCryptoSelection();
    let appState = getAppState();
    checkSpeedExpiry(appState);
    updateMiningBalance(appState); 
    updateUI(appState); 

    if (appState.isMining || appState.fanSpeed > 3) {
        toggleSettingsCardVisibility(true); 
    } else {
        toggleSettingsCardVisibility(false);
    }

    if (appState.isMining) {
        startMiningLoop();
        startCountdown();
    } else {
        document.getElementById('countdownTimer').innerText = 'Aktif Oturum SÃ¼resi: 12:00:00'; 
    }
}

// ğŸ” Firebase GiriÅŸ KontrolÃ¼
onAuthStateChanged(auth, (user) => {
  if (user) {
    // KullanÄ±cÄ± GiriÅŸ YaptÄ±
    userID = user.uid; // GerÃ§ek kullanÄ±cÄ± ID'sini ata
    init();
    console.log("KullanÄ±cÄ± giriÅŸ yaptÄ±: ", userID);
  } else {
    // KullanÄ±cÄ± GiriÅŸ YapmadÄ±
    console.log("KullanÄ±cÄ± oturumu bulunamadÄ±. index.html'ye yÃ¶nlendiriliyor.");
    // âš ï¸ GiriÅŸ sayfasÄ±na yÃ¶nlendir
    window.location.href = 'index.html'; 
  }
});
</script>
  
</body>
</html>
