<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MiningPRO - KazÄ±m Kontrol</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
/* ========================================================================= */
/* --- GENEL STÄ°LLER VE TEMA (Hiz Al SayfasÄ± ile aynÄ±) --- */
/* ========================================================================= */
body, html {
  margin: 0; padding: 0;
  font-family: 'Poppins', sans-serif;
  background: #0D1117; 
  color: #E6EDF3; 
  min-height: 100vh;
  padding-bottom: 70px;
  line-height: 1.6;
}
.wrapper {
  max-width: 550px; 
  margin: 15px auto;
  padding: 0 15px;
}
header {
  background: #161B22;
  padding: 15px;
  text-align: center;
  font-size: 26px;
  font-weight: 800;
  color: #F3BA2F; /* Ana sayfa baÅŸlÄ±k rengi */
  text-shadow: 0 0 10px rgba(243, 186, 47, 0.6); 
  box-shadow: 0 3px 15px rgba(0, 0, 0, 0.8);
  position: sticky;
  top: 0;
  z-index: 100;
  border-bottom: 1px solid #F3BA2F;
}
header i { margin-right: 10px; }

/* ========================================================================= */
/* --- KARTLAR VE BÄ°LGÄ° ALANLARI --- */
/* ========================================================================= */
.card {
  background: #161B22;
  border-radius: 16px; 
  padding: 25px;
  margin-bottom: 25px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); 
  border: 1px solid #2D333B;
  transition: transform 0.3s ease;
}
.card:hover {
    transform: translateY(-2px);
}
.card h2 {
    color: #00BFFF; /* Mavi BaÅŸlÄ±klar */
    font-size: 22px;
    margin-bottom: 15px;
    border-bottom: 2px solid #2D333B;
    padding-bottom: 10px;
    font-weight: 700;
}
.status-info {
    text-align: center;
    font-size: 14px;
    color: #CCC;
    margin-top: 15px;
    padding: 15px;
    border-radius: 8px;
    background: #2D333B;
    border-left: 5px solid #F3BA2F; /* AltÄ±n rengi uyarÄ± */
}

/* --- KAZIM ALANI --- */
.mining-area {
    text-align: center;
    margin: 20px 0;
}
.mining-status {
    font-size: 16px;
    color: #4cd964;
    font-weight: 600;
    margin-bottom: 15px;
}
#currentHashrate {
    font-size: 48px;
    font-weight: 800;
    color: #4cd964;
    text-shadow: 0 0 20px rgba(76, 217, 100, 0.8);
    transition: color 0.5s, text-shadow 0.5s;
}
.hashrate-unit {
    font-size: 20px;
    font-weight: 400;
    color: #E6EDF3;
    margin-left: 5px;
}

/* --- BAÅLAT/DURDUR BUTONU --- */
#toggleMiningBtn {
    padding: 18px 30px;
    border: none;
    border-radius: 50px;
    font-weight: 800;
    font-size: 20px;
    color: #0D1117;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 25px;
    min-width: 250px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}
#toggleMiningBtn i { margin-right: 10px; font-size: 22px; }

/* Durum: KapalÄ± (BaÅŸlat) */
.mining-off {
    background: #4CD964; /* YeÅŸil */
    box-shadow: 0 0 20px rgba(76, 217, 100, 0.7), 0 5px 15px rgba(0,0,0,0.4);
}
.mining-off:hover { 
    background: #66ff88; 
    transform: scale(1.05); 
}

/* Durum: AÃ§Ä±k (Durdur) */
.mining-on {
    background: #FF0057; /* KÄ±rmÄ±zÄ± */
    box-shadow: 0 0 20px rgba(255, 0, 87, 0.7), 0 5px 15px rgba(0,0,0,0.4);
}
.mining-on:hover { 
    background: #ff3377; 
    transform: scale(1.05); 
}

/* --- BAKIYE KARTI --- */
.balance-display {
    text-align: center;
    padding: 15px;
    border-radius: 12px;
    margin-bottom: 20px;
    background: #0D1117;
    border: 1px solid #00BFFF;
    box-shadow: inset 0 0 10px rgba(0, 191, 255, 0.3);
}
.balance-display .label {
    font-size: 16px;
    color: #A0AEC0;
    margin-bottom: 5px;
}
#miningBalance {
    font-size: 36px;
    font-weight: 800;
    color: #00BFFF;
    text-shadow: 0 0 15px rgba(0, 191, 255, 0.8);
}
#miningBalance span {
    font-size: 18px;
    font-weight: 600;
    margin-left: 5px;
}
#speedMultiplier {
    font-size: 18px;
    font-weight: 700;
    color: #F3BA2F;
    margin-top: 10px;
}

/* ========================================================================= */
/* --- ALT MENÃœ (Hiz Al SayfasÄ± ile aynÄ± olmalÄ±) --- */
/* ========================================================================= */
.bottom-menu { 
    position:fixed; bottom:0; left:0; width:100%; display:flex; justify-content:space-around;
    background:#161B22; padding:10px 0; box-shadow:0 -5px 15px rgba(0,0,0,0.5); z-index:99;
    border-top: 1px solid #2D333B;
}
.bottom-menu a {
    flex:1; text-decoration: none; text-align: center; margin:0 5px; padding:8px 0;
    font-size:12px; background:transparent; color:#777; border-radius:8px; transition:.3s;
    font-weight: 600; 
}
.bottom-menu a i { font-size: 20px; display: block; margin-bottom: 4px; }
.bottom-menu a.active { 
    color:#F3BA2F; /* Ana sayfada aktif renk AltÄ±n olsun */
    background: rgba(243, 186, 47, 0.1); 
    text-shadow: 0 0 5px rgba(243, 186, 47, 0.6);
}

/* UyarÄ± Sistemi (Hiz Al SayfasÄ± ile aynÄ±) */
#floatingAlert {
    position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px);
    z-index: 10000; padding: 15px 25px; border-radius: 10px; font-weight: 700; color: #121212;
    box-shadow: 0 5px 20px rgba(0,0,0,0.4); transition: opacity 0.4s, transform 0.4s;
    opacity: 0; pointer-events: none; max-width: 90%; text-align: center;
}
#floatingAlert.show { opacity: 1; transform: translateX(-50%) translateY(0); }
.alert-success { background: #4cd964; }
.alert-error { background: #ff0057; }
.alert-info { background: #00bfff; }
</style>
</head>
<body>

<div id="floatingAlert" class="alert-info"></div>
<header><i class="fas fa-hammer"></i> MiningPRO KONTROL PANELÄ°</header>
<div class="wrapper">

    <div class="card">
        <h2>ğŸ’° KazÄ±m Bakiyesi</h2>
        <div class="balance-display">
            <div class="label">Åu Ana Kadar KazdÄ±ÄŸÄ±nÄ±z Miktar:</div>
            <div id="miningBalance">0.000000 <span>USDT</span></div>
            <div id="speedMultiplier">Aktif HÄ±z: 5x</div>
        </div>
        <div class="status-info">
            <i class="fas fa-info-circle"></i> Bakiyeniz otomatik olarak her 24 saatte bir ana cÃ¼zdanÄ±nÄ±za aktarÄ±lÄ±r.
        </div>
    </div>

    <div class="card">
        <h2>âš¡ CanlÄ± Madencilik Durumu</h2>
        
        <div class="mining-area">
            <div class="mining-status" id="miningStatusText">Madencilik Åu An KapalÄ±.</div>
            <div id="currentHashrate">0.00 <span class="hashrate-unit">MH/s</span></div>

            <button id="toggleMiningBtn" class="mining-off" onclick="toggleMining()">
                <i class="fas fa-play"></i> KAZIMI BAÅLAT
            </button>
        </div>
    </div>
    
    <div class="card">
        <h2>ğŸ“ˆ Verim Analizi</h2>
        <div class="status-info" style="border-left: 5px solid #00BFFF;">
            GÃ¼nlÃ¼k Tahmini KazanÃ§ (5x HÄ±z ile): **$0.80 - $1.20 USDT**
            <br>
            <a href="hiz-al.html" style="color:#00BFFF; font-weight:700;">HÄ±zÄ±nÄ±zÄ± YÃ¼kseltmek Ä°Ã§in TÄ±klayÄ±n!</a>
        </div>
    </div>

</div>

<div class="bottom-menu">
  <a href="miningpro.html" id="tabMining" class="active"><i class="fas fa-tachometer-alt"></i> KazÄ±m</a>
  <a href="hiz-al.html" id="tabHizAl"><i class="fas fa-bolt"></i> HÄ±z Al</a>
  <a href="kazan.html" id="tabKazan"><i class="fas fa-trophy"></i> Kazan</a>
  <a href="cÃ¼zdanÄ±m.html" id="tabWallet"><i class="fas fa-wallet"></i> CÃ¼zdanÄ±m</a>
</div>

<script>
// Hiz Al sayfasÄ±ndan kopyalanan yardÄ±mcÄ± fonksiyonlar
function checkLogin() {
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    if (isLoggedIn !== 'true') {
        window.location.href = 'index.html'; 
        return false; 
    }
    return true;
}
if (!checkLogin()) {
    throw new Error("KullanÄ±cÄ± giriÅŸi yapÄ±lmamÄ±ÅŸ.");
}

let alertTimeout = null;
function showFloatingAlert(message, type = 'info', duration = 3000) {
    const alertEl = document.getElementById('floatingAlert');
    if (!alertEl) return;
    clearTimeout(alertTimeout);
    alertEl.className = '';
    alertEl.classList.add(`alert-${type}`);
    alertEl.innerText = message;
    alertEl.classList.add('show');
    alertTimeout = setTimeout(() => {
        alertEl.classList.remove('show');
    }, duration);
}

function getAppState() {
    const state = localStorage.getItem('miningProState');
    return state ? JSON.parse(state) : {
        isMining: false, // Yeni durum: Madencilik aÃ§Ä±k/kapalÄ±
        miningBalance: 0.0,
        fanSpeed: 5, 
        lastUpdateTime: Date.now(), // Son kazÄ±m zamanÄ±
        purchasedSpeeds: [],
    };
}

function saveAppState(state) {
    localStorage.setItem('miningProState', JSON.stringify(state));
}

// =========================================================================
// --- MADENCÄ°LÄ°K Ä°ÅLEVÄ° ---
// =========================================================================

// HÄ±z Ã§arpÄ±mÄ±na gÃ¶re MH/s deÄŸerini hesapla
function calculateHashrate(speedMultiplier) {
    // 5x (Temel) iÃ§in 0.2 MH/s varsayalÄ±m. Her 1x artÄ±ÅŸ iÃ§in 0.04 MH/s ekleyelim.
    // 20x Max hÄ±z iÃ§in: 0.2 + (15 * 0.04) = 0.8 MH/s
    const BASE_HASHRATE = 0.2; 
    const RATE_PER_MULTIPLIER = 0.04; 
    return (BASE_HASHRATE + (speedMultiplier - 5) * RATE_PER_MULTIPLIER).toFixed(2);
}

// Bakiye simÃ¼lasyonu
function updateMiningBalance(appState) {
    const now = Date.now();
    const timeElapsedHours = (now - appState.lastUpdateTime) / (1000 * 60 * 60); // Saat cinsinden geÃ§en sÃ¼re

    if (appState.isMining && timeElapsedHours > 0) {
        // GÃ¼nlÃ¼k kazanÃ§ simÃ¼lasyonu: 5x hÄ±z iÃ§in gÃ¼nde 1.0 USDT
        const BASE_DAILY_USDT = 1.0; 
        
        // HÄ±z Ã§arpanÄ±na gÃ¶re gÃ¼nlÃ¼k kazancÄ± ayarla (Ã–rn: 20x hÄ±z 4 kat fazla kazandÄ±rsÄ±n)
        const dailyRate = BASE_DAILY_USDT * (appState.fanSpeed / 5); 
        
        // GeÃ§en sÃ¼reye gÃ¶re kazanÃ§ hesaplama
        const earnings = dailyRate * timeElapsedHours / 24;
        
        appState.miningBalance += earnings;
        appState.lastUpdateTime = now; // ZamanÄ± gÃ¼ncelle
        saveAppState(appState);
    }
}

// UI GÃ¼ncellemesi
function updateUI(appState) {
    const btn = document.getElementById('toggleMiningBtn');
    const statusText = document.getElementById('miningStatusText');
    const hashrateDisplay = document.getElementById('currentHashrate');
    const balanceDisplay = document.getElementById('miningBalance');
    const speedDisplay = document.getElementById('speedMultiplier');
    
    // Bakiye ve HÄ±z GÃ¼ncelleme
    balanceDisplay.innerHTML = `${appState.miningBalance.toFixed(6)} <span>USDT</span>`;
    speedDisplay.innerText = `Aktif HÄ±z: ${appState.fanSpeed}x`;
    
    // Buton ve Durum GÃ¼ncelleme
    if (appState.isMining) {
        btn.classList.remove('mining-off');
        btn.classList.add('mining-on');
        btn.innerHTML = '<i class="fas fa-pause"></i> KAZIMI DURDUR';
        statusText.style.color = '#4cd964';
        statusText.innerText = 'Madencilik AKTÄ°F ve Ã‡alÄ±ÅŸÄ±yor.';
        
        // Hashrate gÃ¼ncelleme
        const currentHashrate = calculateHashrate(appState.fanSpeed);
        hashrateDisplay.innerHTML = `${currentHashrate} <span class="hashrate-unit">MH/s</span>`;
        hashrateDisplay.style.color = '#4cd964';
        hashrateDisplay.style.textShadow = '0 0 20px rgba(76, 217, 100, 0.8)';
        
    } else {
        btn.classList.remove('mining-on');
        btn.classList.add('mining-off');
        btn.innerHTML = '<i class="fas fa-play"></i> KAZIMI BAÅLAT';
        statusText.style.color = '#ff0057';
        statusText.innerText = 'Madencilik Åu An KapalÄ±.';
        
        // Hashrate sÄ±fÄ±rlama
        hashrateDisplay.innerHTML = `0.00 <span class="hashrate-unit">MH/s</span>`;
        hashrateDisplay.style.color = '#E6EDF3';
        hashrateDisplay.style.textShadow = 'none';
    }
}

// Buton tÄ±klama fonksiyonu
window.toggleMining = function() {
    let appState = getAppState();
    
    appState.isMining = !appState.isMining;
    appState.lastUpdateTime = Date.now(); // Durum deÄŸiÅŸtiÄŸi an zamanÄ± sÄ±fÄ±rla

    if (appState.isMining) {
        showFloatingAlert(`KazÄ±m ${appState.fanSpeed}x hÄ±z ile baÅŸlatÄ±ldÄ±!`, 'success');
        // Madencilik aÃ§Ä±ksa, bakiye gÃ¼ncelleme dÃ¶ngÃ¼sÃ¼nÃ¼ baÅŸlat
        startMiningLoop();
    } else {
        showFloatingAlert('KazÄ±m durduruldu. Tekrar baÅŸlatabilirsiniz.', 'error');
        // Madencilik durduysa, dÃ¶ngÃ¼yÃ¼ durdur
        clearInterval(miningInterval);
    }
    
    saveAppState(appState);
    updateUI(appState);
}


let miningInterval; // KazÄ±m dÃ¶ngÃ¼sÃ¼nÃ¼ tutacak deÄŸiÅŸken

function startMiningLoop() {
    // Ã–nceki dÃ¶ngÃ¼yÃ¼ temizle
    if (miningInterval) {
        clearInterval(miningInterval);
    }
    
    // Her 5 saniyede bir bakiye ve UI'Ä± gÃ¼ncelle
    miningInterval = setInterval(() => {
        let appState = getAppState();
        if (appState.isMining) {
            updateMiningBalance(appState);
            updateUI(appState);
        } else {
            // EÄŸer isMining false ise interval'Ä± temizle
            clearInterval(miningInterval);
        }
    }, 5000); 
}


// BaÅŸlangÄ±Ã§ Fonksiyonu
function init() {
    let appState = getAppState();
    
    // Bakiye gÃ¼ncellemesini baÅŸlangÄ±Ã§ta bir kez yap (kapalÄ± olsa bile geÃ§en sÃ¼reyi hesaplamak iÃ§in)
    updateMiningBalance(appState); 
    
    // UI'Ä± mevcut duruma gÃ¶re ayarla
    updateUI(appState); 

    // EÄŸer madencilik aÃ§Ä±ksa, dÃ¶ngÃ¼yÃ¼ baÅŸlat
    if (appState.isMining) {
        startMiningLoop();
    }
}

// Sayfa yÃ¼klendiÄŸinde baÅŸlat
document.addEventListener('DOMContentLoaded', init);
</script>
  // miningpro.html dosyasÄ±nÄ±n en baÅŸÄ±ndaki script bloÄŸuna ekle:

onAuthStateChanged(auth, (user) => {
    if (!user || !user.emailVerified) {
        // KullanÄ±cÄ± giriÅŸ yapmamÄ±ÅŸsa veya e-postasÄ± doÄŸrulanmamÄ±ÅŸsa, giriÅŸ sayfasÄ±na geri gÃ¶nder.
        window.location.href = "index.html"; 
    } else {
        // GiriÅŸ yapÄ±ldÄ±ysa sayfa yÃ¼klemesini baÅŸlat
        init(); 
        startMiningLoop();
    }
});

// â— Ã–NEMLÄ°: Bu kodu ekledikten sonra, bu satÄ±rÄ± silin veya yorumlayÄ±n:
// document.addEventListener('DOMContentLoaded', init);
  
</body>
</html>
